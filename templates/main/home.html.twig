{% extends 'base.html.twig' %}

{% block title %} | Home{% endblock %}

    {% block main %}

        <div id="filtres_sorties" class="row justify-content-center">
            <div id="filtres_champs" class="col-10">
                <div id="filtre_campus" class ="col-4">
                    {{ form_start(campus_form, {attr: {'novalidate': 'novalidate'}}) }}
                    {{ form_label(campus_form.campus) }}
                    {{ form_widget(campus_form.campus) }}
                    {{ form_end(campus_form) }}
                </div>

            </div>




        </div>

        <div id="barre_nav" class = "row justify-content-end">
            <div class="col-1">Villes</div>
            <div class="col-1">Campus</div>
            <div class="col-1"></div>
        </div>
        <div id="filtres"></div>
        <div id="liste_sorties" class="row justify-content-center">
            <table id="tab_sorties" class="col-10">
                <thead>
                <tr>
                    <th class="col-3">Nom de la sortie</th>
                    <th class="col-1">Date de la sortie</th>
                    <th class="col-1">Cl√¥ture</th>
                    <th class="col-1">inscrits/places</th>
                    <th class="col-1">Etat</th>
                    <th class="col-1">Inscrit</th>
                    <th class="col-2">Organisateur</th>
                    <th class="col-2">Actions</th>
                </tr>
                </thead>
                <tbody id="lignesSorties">
                    {% for sortie in sorties %}
                    <tr data-id-campus="{{ sortie.campusOrganisateur.id }}">
                    <td class="col-3">{{ sortie.nom }}</td>
                    <td class="col-1">{{ sortie.dateHeureDebut|date('Y-m-d') }}</td>
                    <td class="col-1">{{ sortie.dateLimiteInscription|date('Y-m-d') }}</td>
                    <td class="col-1">{{ sortie.participants|length }}/{{ sortie.nbInscriptionsMax }}</td>
                    <td class="col-1">{{ sortie.etat.libelle }}</td>
                    <td class="col-1">...</td>
                    <td class="col-2">{{ sortie.organisateur.pseudo }}</td>
                    <td class="col-2"><a href="{{ path('sorties_detail',{id:sortie.id}) }}">S'inscrire</a></td>
                    </tr>
                    {%  endfor %}
                </tbody>

            </table>
        </div>
        <script> window.onload=init;
        var listeCampus;
        var lignesSorties;
    function init(){
        listeCampus = document.getElementById('filtres_sorties_form_campus');
        lignesSorties = document.getElementById('lignesSorties');
        let optionAllCampus = document.createElement("option");
        optionAllCampus.value='0';
        optionAllCampus.innerText='Tous';
        listeCampus.prepend(optionAllCampus);
        listeCampus.value='0';
        listeCampus.onchange=campusSelect;
    }
    function campusSelect() {
        let idcampus=listeCampus.value;

        let tr_lignesSorties = lignesSorties.children;
        for(var i=0; i<tr_lignesSorties.length; i++){

            if(tr_lignesSorties[i].dataset.idCampus === idcampus || idcampus==='0'){
                tr_lignesSorties[i].style="";

            }else
            {
                tr_lignesSorties[i].style.display="none";
            }
        }




    }

        </script>
    {% endblock%}